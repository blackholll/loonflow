==============
发布说明
==============



---------
r2.0.20
---------
- 修复: docker compose部署方式 初始化sql中示例工作流配置代码错误


---------
r2.0.19
---------
- 修复: 新建工单时不应该出现留言的按钮
- 修复: 初始sql中示例工作流配置信息错误
- 修复: 转交工单，加签工单未触发通知hook


---------
r2.0.18
---------
- 修复:【用户管理】添加用户时候必填项标记缺失
- 优化:【部署】docker compose部署新增media目录配置
- 优化:【管理后台】svg背景文件迁移到本地
- 修复:【用户管理】部门管理页面新增记录时上级部门只能选择当前页列表中的部门
- 修复:【用户管理】用户角色页面无法切换当前页
- 修复:【工单详情】当日期或日期时间字段为空时直接退回工单，会导致后续此字段无法编辑
- 修复:【工单详情】处理工单时文件类型字段的必填校验不生效


---------
r2.0.17
---------
- 修复: 【工单详情】日期类型字段有值且可编辑状态下工单详情页面报错问题
- 修复: 【工单详情】文件类型字段无值时且当前配置展示时工单详情页面报错问题
- 优化: 【文档】readme文档更新


---------
r2.0.16
---------
- 优化:【部署】简化docker compose部署方式，image已传docker hub，不再需要本地build image,支持容器启动mysql
- 修复:【接口】工作流列表接口中admin列表信息返回错误
- 优化:【新功能】支持配置hook_url的host可信列表,提供安全性
- 修复:【管理后台】状态列表及自定义字段列表前端代码中per_page参数typo(实际不影响功能)
- 修复:【管理后台】工作流配置相关页面在第二页新增配置后列表页码显示错误
- 修复:【代码逻辑】工单标题模板未支持内置字段(creator、sn等)
- 修复:【代码逻辑】新建工单后，工单列表页面需要1分钟后才显示最新工单记录
- 修复:【管理后台】登录失败页面没有提示信息
- 修复:【代码逻辑】工单执行状态hook时，如果成功执行则没有记录操作日志问题
- 修复:【代码逻辑】新建工单的限制表达式中count参数实际未生效问题


---------
r2.0.15
---------
- 修复: 升级python版本后导致的docker-compose方式部署无法启动问题
- 修复: 处理人类型使用外部获取时计算最终处理人处理出错问题
- 修复: 第二个状态的处理人类型为外部获取，出发hook时丢失工单信息问题


---------
r2.0.14
---------
- 优化: 工单当前所处状态被删除，工单详情api不报错
- 优化: 升级python版本到3.10, 使用pymysql替换mysqlclient降低安装复杂度
- 优化: 将前端icon文件迁移到本地，避免用户无法链接外网导致页面打开非常缓慢
- 优化: 初始化sql更新
- 优化: 更新文档中的截图到最新版本
- 修复: 工单详情接口返回内容中创建人所属部门id信息内容错乱问题
- 修复: redis server未配置密码导致创建工单提示"Client sent AUTH, but no password is set"问题
- 新增: 工单处理人新增支持在流程过程中实时从外部获取
- 新增: 英文版readme


---------
r2.0.13
---------
- 修复: 新建工单界面错误的显示了工单列表(子工单列表没处理好导致的)
- 修复: 生产环境部署后，错误日志未被记录问题
- 修复: 当工单状态的处理人是全部处理，且按照不同的处理路径处理完后，再强制修改状态，会导致工单无法继续处理问题


---------
r2.0.12
---------
- 优化: 管理员工单列表支持删除工单
- 优化: 工单详情页支持创建人关闭及撤回工单
- 优化: 工单详情页处理工单按钮支持点击后弹窗提示
- 优化: 工单列表接口支持查询子工单
- 优化: 工单详情页面显示子工单列表
- 修复: 日期字段未填写无法提交工单问题
- 修复: 强制修改工单状态，未触发通知hook问题
- 修复: 工作流配置时流转操作的开启弹窗switch无法生效问题


---------
r2.0.11
---------
- 后端首页去除登录认证
- 修复:表单中包含时间或日期类型只读时无法提交或处理工单问题
- docker compose部署使用utf8mb4字符集
- 修复:流程图界面未import message导致出错是页面崩溃问题
- 修复: 开发模式下提交或处理工单无法上传附件问题
- 优化: 移除工单内置字段的描述信息，避免在工单详情页面显示
- 修复: 新建流程时，配置了条件表达式，未选择目标状态会无法保存问题
- 修复: 开发环境下工单详情中附件无法访问问题
- 优化: 工单详情中下载文件保存为原有文件名
- 优化: 未配置工作流展示表单导致工单详情页面报错问题
- 部署: docker compose部署方式的一些备注信息
- 修复: 新增用户时所在部门只能选择前10个问题
- 修复: 配置了查看或干预权限但是工单查看、工单干预页面列表返回空问题


---------
r2.0.10
---------
- 兼容:【流程图】前端ant design 的chart版本自动升级后导致流程图页面打开报错问题兼容
- 兼容:【部署】docker compose部署方式，因为下载nodejs的源证书问题，导致无法下载的兼容

---------
r2.0.9
---------
- 新增:【详情页面】支持加签完成操作
- 优化:【接口】工单状态删除后，不影响列表接口的数据返回(不抛异常，已'未知状态'代替)
- 修复:【接口】hook操作后未记录操作类型，导致操作日志接口中hook操作的名称为'未知'问题
- 优化:【代码逻辑】提高eval的安全性


---------
r2.0.8
---------
- 修复:【代码逻辑】应用接口调用权限添加后无法通过权限校验问题


---------
r2.0.7
---------
- 修复:【代码逻辑】计算用户上级部门逻辑错误
- 修复:【管理后台】工作流调用权限无法添加成功问题
- 修复:【管理后台】角色用户管理中无法添加角色用户问题
- 修复:【管理后台】工作流基础配置中添加应用授权时无法搜索应用问题
- 优化:【管理后台】工作流状态列表中显示状态id,方便些条件表达式
- 优化:【管理后台】应用调用权限记录新增或者编辑是应用名不允许重复
- 优化:【接口】工单操作记录中使用的流转操作被删除后，操作记录接口报错问题优化
- 优化:【接口】新建工单时如果redis未启动时提示信息优化
- 优化:【文档】新增对前端部分代码接口的描述说明
- 优化:【代码】移除已废弃的前端页面及相关图片


---------
r2.0.6
---------
- 修复:【管理后台】工作流列表分页无效问题
- 修复:【管理后台】工作流无法删除问题
- 修复:【管理后台】参与人类型选择无， 参与人还是必填问题
- 修复:【管理后台】部门新增不选择审批人时，无法添加问题
- 修复:【管理后台】工作流编辑时,删除api授权应用后无法再次添加回来问题
- 优化:【管理后台】部门列表中显示部门的审批人姓名及leader的姓名
- 修复:【部署】docker compose方式无法停止服务,即执行python3 run.py stop报错问题
- 优化:【部署】docker compose部署支持升级


---------
r2.0.5
---------
- 修复:【管理后台】工作流编辑时选择通知的回显异常问题
- 修复:【管理后台】工作流状态流转等多次编辑时json被重复转换导致内容异常问题
- 修复:【管理后台】用户所属部门无法被删除问题
- 修复:【工单详情】多选类型字段无法提交问题
- 修复:【管理后台】选择类型字段只读状态显示异常问题
- 新增:【工单详情】新增支持富文本的显示及回显
- 优化:【API】工单列表中工单处理人为多人时的性能优化

---------
r2.0.4
---------
- 修复:【部署】初始sql中有个字段写错了导致无法添加调用权限记录问题
- 优化:【管理后台】流程图显示优化
- 修复:【管理后台】部门列表只能显示第一页问题
- 修复:【管理后台】添加部门弹窗中默认的审批人信息错误导致无法直接添加部门问题
- 修复:【管理后台】添加调用权限记录弹窗中默认工作流选择初始值为空导致无法直接添加问题

---------
r2.0.3
---------
- 修复:【管理后台】工作流管理页面查询条件不生效问题
- 修复:【管理后台】工单列表筛选条件(创建人、创建时间不生效)问题
- 修复:【管理后台】流程图中条件表达式无法显示显示问题
- 修复:【管理后台】定时器没有配置入口问题
- 修复:【管理后台】工作流创建时部分人员信息未保存问题
- 修复:【管理后台】流转记录编辑后会新增一条记录问题
- 修复:【管理后台】hook类型前端显示错误问题
- 修复:【部署】docker compose部署时，数据库导入失败未停止部署进程问题
- 修复:【部署】docker compose部署，导如初始化数据时，数据库端口指定不生效问题


---------
r2.0.2
---------
- 修复: 创建工单时填写内容不合法时会跳转到报错页面问题
- 修复: 新创建的用户无法登录问题
- 修复: 普通用户无法被重置密码问题
- 修复: 不同用户类型的权限不生效问题
- 修复: 超级管理员无法管理所有工单问题
- 修复: 普通用户可以查看干预工单菜单问题
- 修复: 无法删除角色问题
- 修复: 工单列表中查询条件工作流类型不生效问题
- 修复: 标题模板配置后不生效问题
- 优化: 未选择工作流时，点击新建工单按钮，弹窗报错问题


---------
r2.0.1
---------
- 修复: docker compose方式部署时，提示权限问题
- 修复: 管理后台新增工作流报错问题


---------
r2.0.0
---------
- 自带工单创建、查看、处理、管理界面(本次最大改动)
- 支持用户同时属于多个部门(本次较大改动)
- flowlog接口支持指定顺序或者倒序
- 工作流配置界面支持查看每天新增工单统计
- 工单详情中支持管理员干预工单
- 支持用户自行修改密码
- 其他若干优化



---------
r1.0.13
---------
- 修复: 创建人关闭工单功能异常
- 修复: 多人处理工单逻辑异常
- 修复: hook处理未正常记录hook执行状态
- 修复: 处理工单时，在操作记录中记录的所有字段值信息格式错误


---------
r1.0.12
---------
- 修复: 管理后台工作流列表查询不生效
- 修复: 管理后台无法新增部门
- 修复: 撤回工单后,未出现在创建人的待办列表中
- 修复: 处理人类型为hook时 状态无法流转
- 修复: 处理人类型为hook，当处理失败时未成功保存工单所有字段信息
- 修复: 多人处理是去重逻辑问题
- 优化: 管理后台支持回车登录


---------
r1.0.11
---------
- 修复: 当用户无处理权限时，获取用户可执行操作接口返回结果格式不合理
- 修复: 工单被撤回时，工单进行状态字段值未被更新，导致此状态无法被查询
- 修复: 工作流编辑时，标题模板及通知模板被修改后，前端未更新显示
- 修复: 角色用户无法被成功删除
- 修复: 工单操作记录中处理意见无法被成功保存


---------
r1.0.10
---------
- 修复: 当参与人类型为部门，且参与人设置了多个部门id(逗号隔开)时，无法正确流转到对应的人
- 修复: 管理后台中配置流转时，"点击弹窗提示	"属性无法成功保存问题


---------
r1.0.9
---------
- 修复: 工单加签完成后，当前处理人待办列表中无该工单问题
- 修复: 多人全部处理完成后，下个状态处理人类型如果是工单字段时，无法获取到当前处理人问题
- 优化: 修改工单基础表中当前参与人字段的长度，修改工单处理记录中处理意见字段的长度, 修改工作流状态中参与人字段长度


---------
r1.0.8
---------
- 修复: 当工单当前状态需要接单时，获取用户可以做的流转接口报错
- 修复: 无法删除角色的用户记录
- 优化: 不请求favicon.ico


---------
r1.0.7
---------
- 修复: 状态分配方式为全部处理，且参与人设置为工单字段情况下，其中一个人处理就直接到下个状态问题
- 修复: 状态hook回调时 result传false后， 实际工单脚本hook执行状态未更新问题
- 修复: 状态参与人设置为父工单字段时，功能不正常
- 新增: 工单状态参与人类型变量、工单字段、父工单字段支持设置多个(逗号隔开)


---------
r1.0.6
---------
- 优化: hook流转suggestion获取方式调整
- 优化: sphinx文档新增几个常见问题及解答
- 优化: readme中调用方demo相关信息修改


---------
r1.0.5
---------
- 修复: 状态参与人为多人，且分配方式为全部处理时，参与人没有处理完就流转到下个状态的问题
- 修复: 状态参与人为hook, wait=false（即不等待回调，直接流转）情况下，无法正常流转问题
- 新增: 新增基于钉钉生态的移动端调用方开源审批系统项目，https://gitee.com/shihow/howflow-open


---------
r1.0.4
---------
- 修复: 工单自定义字段的值不能被正常更新问题
- 修复: 处理人为多部门时,处理人计算错误问题
- 修复: 撤回工单未更新工单状态问题


---------
r1.0.3
---------
- 修复: 强制修改工单状态后处理人异常问题
- 修复: 撤回工单条件判断逻辑错误问题
- 新增: 新增docker compose方式部署loonflow_shutongflow(仅供演示用)


---------
r1.0.2
---------
- 修复: 获取工作流状态详情接口报错问题
- 修复: 还没有配置工作流时，工单管理界面报错问题
- 修复: 部门编辑时未选择部门审批人无法保存问题修复
- 修复: 编辑工作流时候标题模板，内容模板未成功保存问题
- 修复: 处理人类型为工单字段时， 获取处理人信息错误问题
- 修复: 配置流转时候目标状态不选时，导致流转列表出不来问题
- 修复: 管理后台中强制修改工单状态导致工单无法被继续处理问题
- 修复: 状态强制修改为初始状态或者结束状态时， 处理人错误问题
- 修复: 调用权限编辑后再新增记录时，表单中遗留了上次编辑的内容问题
- 修复: readthedoc文档中允许启动命令中中两个-被转成了一个--问题说明
- 修复: 使用uwsgi部署后，日志文件没有内容问题(临时改成打印日志到控制台，可取uwsgi日志中查看日志)
- 优化: 新增工作流后提示用户去添加调用权限
- 优化: 配置工作流 选择通知的地方，加个提示 如何新增通知


---------
r1.0.1
---------
- 修复: 生产环境依赖包uwsgi版本更新
- 修复: 工单列表查询条件创建起止时间处理逻辑错误
- 修复: 评论工单接口逻辑错误
- 修复: 强制关闭后工单的进行状态属性未更新问题
- 修复: 状态参与人类型是角色时导致处理人异常问题
- 修复: 部分情况下工单列表接口查询我的待办工单返回数据错误
- 新增功能: 工单列表支持我处理过的工单查询
- 新增功能: 工单列表查询api的状态属性条件支持“已关闭”查询
- 优化: 管理后台中工单管理异常情况提示信息优化及一些其他细节优化


---------
r1.0.0
---------
- 升级python3.6
- 配置文件统一修改为config.py
- 新增接口：撤回工单
- 工单详情接口新增返回当前状态的详细信息
- 允许工单创建人在工单的初始状态直接关闭工单
- 工单列表接口性能优化
- flowstep接口中新增返回当前状态信息，并且记录按照state的顺序id排序
- 工单列表查询接口新增支持查询条件: 草稿中、进行中、被撤回、被退回、完成
- 自定义通知由脚本修改为hook方式
- 管理后台首页新增工单数量分类统计
- 管理后台显示当前详细版本号
- 管理后台支持用户、部门、角色编辑
- 管理后台配置状态时，初始及结束状态隐藏处理人输入框信息
- 管理后台支持对工单干预处理: 直接关闭、转交、修改工单状态、删除
- 状态参与人类型是部门时，支持设置多个部门
- 流转操作支持目标状态为初始状态：不再需要额外配置一个”发起人编辑中“这样的中间状态
- 工作流状态hook，支持配置额外参数信息
- 管理后台权限控制细化：分为超级管理员和工作流管理员
- 使用readthedoc管理项目文档
- 静态文件由cdn移到本地,避免内网部署无外网访问权限时无法正常使用
- 代码结构及内部逻辑优化(去除冗余代码、单例模式减少内存占用、数据库操作语句优化、type hints、view参数强校验等)

--------
r0.x.x
--------
见github release
https://github.com/blackholll/loonflow/releases
